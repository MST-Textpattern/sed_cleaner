h1. sed_cleaner

A plugin for "Textpattern":http://textpattern.com.


h2. Description.

Designed to do a little cleanup in *new* textpattern installations. Note the *new* in that statement.
It can also automatically install plugins that you might have included in your installation's @files@ directory.


h2. Primary Targets.

When enabled, this plugin will terminate the following with extreme prejudice...

* Comments
* Links
* Images
* Categories (of all types)
* Articles
* Files
* Any additional table's content you've scripted in your optional @cleanups.php@ file.

*Do not use this plugin in existing installations with any content you wish to keep.*


h2. Secondary Targets.

In addition, this plugin will adjust a few preferences...

* The default custom fields are removed
* The site slogan is blanked
* DNS and spam lookups are turned off
* Email addresses are hidden in comments
* Any preference you've scripted in your optional @cleanups.php@ file

h2. Filesystem Targets.

Where filesystem permissions allow the plugin will...

* Remove the setup directory
* Remove the contents of the @files@ directory (in case you used a cleanups file or autoloaded plugins -- see later)
* Any directory you've scripted in your optional @cleanups.php@ file


h2. Final Target.

After searching out all the above sed_cleaner will self-terminate.


h2. Usage & Installation.

h3. a) Basic content reset...

# Either compile the plugin or "download it.":https://gist.github.com/1114938
# In your new installation, go to @admin > plugins@ and upload the plugin
# Enable the plugin
# Navigate to any other admin side tab.

Your site should now have all its content removed and the sed_cleaner plugin will no longer be installed.


h3. b) Content reset PLUS automatic plugin installation...

# Upload the compiled plugin files you wish to have autoinstalled into the site's @files@ directory. This can be done via ftp or via textpattern's @content > files@ tab. If you take the time to collate all your standard plugins into your deplopyment _before_ you ftp it up to your new site's server then you are really cooking.
# Now proceed with the steps in a) above.

Your site should now have all its content removed and have all the plugins installed that you uploaded to the @files@ directory.


h3. c) Content reset, plugin installation PLUS customised prefs...

# Create a customised @cleanups.php@ script.
# Upload it to the site's @files@ directory (either via ftp or textpattern's @content > files@ tab.)
# Now proceed with the steps in b) above.

Your site should now have its content removed, plugins installed and preferences set.


h2. The cleanups.php file.

This optional file allows you to define additional custom actions to be taken by sed_cleaner.

You can customise the cleanup actions to be taken by editing the file. Once you're happy with your cleanups file you should upload it to your site's @files@ directory. If sed_cleaner finds this "scripting" file it will attempt to perform the additional cleanup actions defined in it.

h3. Command descriptions...

|_. Command |_. Purpose |_. Arguments |_. Examples |
|^. @setpref@ |^. Sets the named preference to the given value. |^. The name of the preference, followed by the value in double quotes. |^. @'setpref dateformat "%Y-%m-%d %H:%M"'@ |
|^. @truncate@ |^. Resets the named table. |^. The name of the table to reset. |^. @'truncate txp_discuss_ipban'@ |
|^. @removedir@ |^. Removes the named directory (non recursive) relative to the textpattern directory |^. The directory to be removed. |^. @'removedir ../rpc'@ |
|^. @enableplugin@ |^. Enables the named plugin (if installed) |^. The plugin to be enabled. |^. @'enableplugin smd_admin_themes'@ |
|^. @disableplugin@ |^. Disables the named plugin (if installed) |^. The plugin to be disabled. |^. @'disableplugin smd_admin_themes'@ |


Please study the packaged cleanups.php file for more examples.

h2. License.

GPLv2

